{
    "version": "2.0.0",
    "tasks": [
        {
            "label": "Build md_converter",
            "type": "cppbuild",
            "command": "cl.exe",
            "args": [
                "/Zi",
                "/EHsc",
                "/I/md4c/src",                               // Include MD4C headers
                "/Fo:./build/md_converter",                  // Redirect .obj files to 'build' directory
                "/Fd:./build/md_converter",                  // Redirect .pdb file to 'build' directory
                "/nologo",
                "/Fe${fileDirname}/build/md_converter/${fileWorkspaceFolderBasename}.exe",
                "${file}"
            ],
            "options": {
                "cwd": "${fileDirname}"
            },
            "dependsOn": "Compile MD4C (Shared Library)", // Build md4c first
            "problemMatcher": [
                "$msCompile"
            ],
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "detail": "Task generated by Debugger."
        },
        {
            "label": "Configure MD4C (Shared Library)",
            "type": "shell",
            "command": "cmake",
            "args": [
              "-S", "md4c",                  // Specify the source directory containing MD4C's CMakeLists.txt
              "-B", "build/md4c",            // Specify the build directory for MD4C
              "-G", "Visual Studio 17 2022", // Use the appropriate generator for your MSVC version
              "-DBUILD_SHARED_LIBS=ON"       // Build as a shared library
            ],
            "options": {
                "env": {
                  "PATH": "C:/Program Files/CMake/bin;${env:PATH}"  // Add CMake to the PATH for this task
                }
            },
            "group": {
              "kind": "build",
              "isDefault": false
            },
            "problemMatcher": [],
            "detail": "Configures MD4C using CMake"
        },
        {
            "label": "Compile MD4C (Shared Library)",
            "type": "shell",
            "command": "cmake",
            "args": [
              "--build", "build/md4c",      // Build the MD4C shared library
              "--config", "Release"         // Use the Release configuration
            ],
            "options": {
                "env": {
                  "PATH": "C:/Program Files/CMake/bin;${env:PATH}"  // Add CMake to the PATH for this task
                }
            },
            "group": {
              "kind": "build",
              "isDefault": false
            },
            "dependsOn": "Configure MD4C (Shared Library)", // Ensure configuration is done before building
            "problemMatcher": [],
            "detail": "Builds MD4C as a shared library"
        }
    ]
}